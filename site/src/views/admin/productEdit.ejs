<!DOCTYPE html>
<html lang="es">

<%- include('./partials/head') %>

  <body>
    <%- include('../partials/headerAdmin.ejs') %>

      <div class="container contenido nuevo-producto">
        <!-- Titulo -->
        <h1 class="col">EDITAR PRODUCTO</h1>

        <form class="col-12 row" action="/admin/products/<%= dataProduct[4].id %>?_method=PUT " method="POST" enctype="multipart/form-data">
          <!-- Carrusel -->
          <div class="carrusel-add-image col-12 col-lg-6">
            <div id="carousel-controller" class="carousel slide" data-ride="carousel">
              <div class="carousel-inner">
                <div class="carousel-item active">
                  <img src="/images/productos/<%= dataProduct[4].images[0].img_name %>" class="imagen-carrusel" alt="...">
                </div>
                <% for( let index = 1; index < dataProduct[4].images.length; index++ ) { %>
                  <div class="carousel-item">
                      <img src="/images/productos/<%= dataProduct[4].images[index].img_name %> " class="imagen-carrusel" alt="...">
                  </div>
              <% } %>
                
              </div>
              <a class="carousel-control-prev" href="#carousel-controller" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
              </a>
              <a class="carousel-control-next" href="#carousel-controller" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
              </a>
            </div>
            <!-- Boton agregar imagen -->
            <div class="boton-image col-12">
              <label class="btn btn-success" for="archivo">Agregar foto</label>
              <input type="file" name="img" id="archivo" multiple >
            </div>
          </div>

          <!-- CAMPOS -->
          
          <div class="col-12 col-lg-6">
            <!-- Animales y Categorías -->
            <div class="campo-animal margen">
              <select class="seleccionar col-5" name="animal">
                <% dataProduct[0].forEach(data=> { %>
                  <option value=<%=data.id %> <%= data.id === dataProduct[4].subCategory.category.animal.id? 'selected' : null %>  ><%= data.animal %> </option>
                  <% }) %>
              </select>
              <span class="obligatorio col-1">*</span>

              <select class="seleccionar col-5" name="category">

                <% dataProduct[1].forEach(categoria=> { %>
                  <option value=<%=categoria.id %> <%= categoria.id === dataProduct[4].subCategory.category.id? 'selected' : null %> ><%= categoria.category %>
                  </option>
                  <% }) %>

              </select>
              <span class="obligatorio col-1">*</span>

            </div>

            <!-- Subcategoria -->
            <select class="sub-categoria margen" name="subCategory">

              <% dataProduct[2].forEach(subcat=> { %>
                <option value=<%=subcat.id %> <%= subcat.id === dataProduct[4].subCategory.id? 'selected' : null %> ><%= subcat.sub_category %>
                </option>
                <% }) %>

            </select>

            <!-- Nombre -->
            <div class="nombre margen">
              <input class="completar col-11" type="text" name="name" placeholder="Nombre" value="<%= dataProduct[4].name %>">
              <span class="obligatorio col-1">*</span>
            </div>

            <!-- Descripcion -->
            <div class="descripcion margen">
              <textarea class="completar col-11" name="description" cols="30" rows="3"
                placeholder="Descripción"><%= dataProduct[4].description %></textarea>
            </div>

            <!-- Cantidad y precio -->
            <div class="cantidad-precio margen">
              <!-- cantidad -->
                <input class="completar col-5" type="number" name="cuantity" min="1" step="1" placeholder="Cantidad"  value="<%= dataProduct[4].cuantity %>" />
                <span class="obligatorio col-1">*</span>
              <!-- Precio -->
                <input class="input-precio completar col-5" type="number" name="price" min="1" step="1" placeholder="$ Precio"  value="<%= dataProduct[4].price %>" />
                <span class="obligatorio col-1">*</span>
            </div>

            <!-- etiqueta y descuento -->
            <div class="etiqueta-descuento margen">
              <select class="seleccionar col-5" name="label" id="etiqueta">
              <% dataProduct[3].forEach(etiqueta=> { %>
                <option value=<%=etiqueta.id %> <%= etiqueta.id === dataProduct[4].label.id? 'selected' : null %> ><%= etiqueta.label %>
                </option>
                <% }) %>
              </select>
                <!-- Espacio -->
                <div class="col-1"></div>

              <!-- descuento -->
                <input class="completar col-5" type="number" name="discount" min="0" max="100" step="1" placeholder="% descuento"  value="<%= dataProduct[4].discount %>" />
            </div>

            <!-- vencimiento(etiqueta-descuento) y precio final -->
            <div class="vencimiento-precio-final margen">
              <!-- vencimiento -->
              
                <input class="vencimiento seleccionar col-5" type="date" name="expiration" placeholder="Vencimiento"  value="<%= dataProduct[4].expiration %>">
                <!-- Espacio -->
                <div class="col-1"></div>
              
              <!-- Precio final -->
              
                <input class="completar col-5" type="text" name="finalPrice" placeholder="$ Precio final"  value="<%= dataProduct[4].final_price %>">
              
            </div>
            <span class="margen">* Campos obligatorios</span>
          </div>
          <!-- Botones -->
          <div class="botones col-12 row">
            <a href="/admin/products/<%= dataProduct[4].id %> " class="btn btn-danger resetear col-5">Cancelar</a>
            <button class="btn btn-success crear col-5" type="submit">Aceptar</button>
          </div>
        </form>
      </div>


      <%- include('../partials/footer') %>
      <script>
        var check = document.getElementById("cambiarModo");
    
        check.onclick = () => {
            document.querySelector("body").classList.toggle('active');
        }
    </script>
  </body>

</html>